webpackJsonp([19],{"0vE1":function(e,t,a){var r=a("F3H6");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("20af3102",r,!0,{})},F3H6:function(e,t,a){t=e.exports=a("FZ+f")(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"ZwProduct.vue",sourceRoot:""}])},"gSX+":function(e,t,a){"use strict";function r(e){a("0vE1")}Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),o=a.n(s),n=a("exGp"),i=a.n(n),c=a("UgCr"),u={components:{},data:function(){return{productId:null,projectData:{},argeeChecked:!1,productInfo:{},priceLoading:!1,payMent:1,userStatus:"",crmData:{city:"",region:"",crmCustId:"",crmCustIdTmp:"",showCusId:"",accountId:"",accountIdTmp:"",showAccountId:"",yunAccountInfo:"",yunAccountTmp:"",bizId:""},configData:[],subOrderData:{},totalPrice:0,staticData:{isOutAccount:{},accountType:{},charging:{},cloudHost:{},imagesTypeList:[],loginType:{},ipChoose:{},orderType:{},systemType:[],cpu:{},timeList:[],numList:{}},formData:{buyTime:{keyValue:12},buyNum:1,resourcePool:"",systemType:{},imagesType:{},images:{},imageId:null,vpc:"",subNet:"",safeGroup:"",password:"",passwordSure:""},flavorId:"",specsData:{configFlavorId:"",flavorId:"flavorTemId",diskType:"",flavorName:"",flavorComment:"",flavorPrice:0},resourcePoolList:[],imagesTypeList:[],imagesSysTemList:[],imagesList:[],vpcList:[],subNetList:[],securityGroupList:[],templateRadio:"",configLoaidng:!1,isDefaultVpc:!1,orderInitData:{},safeGroupList:[],netTypeList:[],netList:[],flavorList:[],allFlavorList:[],flavorData:{},selectTableRow:{}}},mounted:function(){document.documentElement.scrollTop=0},computed:{},created:function(){try{this.productId=Number(this.$route.query.productId)}catch(e){this.productId=0}this.userStatus=this.$store.getters.userInfo.userStatus,this.getBaseData(),this.getResourceList(),this.getFlavors()},methods:{crmInfo:function(e){this.crmData=e},handleProject:function(e){this.projectData=e},getBaseData:function(){var e=this;return i()(o.a.mark(function t(){var a,r,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e,t.prev=1,e.configLoaidng=!0,t.next=5,Object(c.r)({typeCode:"1,2,3,4,5,6,7,8,9,10,timeKey,numKey"});case 5:if(r=t.sent,!Array.isArray(r)){t.next=39;break}s=0;case 8:if(!(s<r.length)){t.next=39;break}t.t0=r[s].typeCode,t.next="1"===t.t0?12:"2"===t.t0?14:"3"===t.t0?16:"4"===t.t0?18:"5"===t.t0?20:"6"===t.t0?22:"7"===t.t0?24:"8"===t.t0?26:"9"===t.t0?28:"10"===t.t0?30:"timeKey"===t.t0?32:"numKey"===t.t0?34:36;break;case 12:return a.staticData.isOutAccount=r[s],t.abrupt("break",36);case 14:return a.staticData.accountType=r[s],t.abrupt("break",36);case 16:return a.staticData.charging=r[s],t.abrupt("break",36);case 18:return a.staticData.cloudHost=r[s],t.abrupt("break",36);case 20:return a.staticData.imagesTypeList.push(r[s]),t.abrupt("break",36);case 22:return a.staticData.loginType=r[s],t.abrupt("break",36);case 24:return a.staticData.ipChoose=r[s],t.abrupt("break",36);case 26:return a.staticData.orderType=r[s],t.abrupt("break",36);case 28:return a.staticData.systemType.push(r[s]),t.abrupt("break",36);case 30:return a.staticData.cpu=r[s],t.abrupt("break",36);case 32:return a.staticData.timeList.push(r[s]),t.abrupt("break",36);case 34:return a.staticData.numList=r[s],t.abrupt("break",36);case 36:s++,t.next=8;break;case 39:e.formData.buyTime=a.staticData.timeList[11];case 40:return t.prev=40,e.configLoaidng=!1,t.finish(40);case 43:case"end":return t.stop()}},t,e,[[1,,40,43]])}))()},getResourceList:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.configLoaidng=!0,e.formData.resourcePool="",t.next=5,Object(c.E)({sysId:"ZW"});case 5:a=t.sent,e.resourcePoolList=a.result;case 7:return t.prev=7,e.configLoaidng=!1,t.finish(7);case 10:case"end":return t.stop()}},t,e,[[0,,7,10]])}))()},resourceChange:function(){this.formData.vpc="",this.formData.subNet="",this.queryFlavorList(),this.queryVirtualEntry(),this.queryNetTypeList(),this.queryNetwork(),this.getImages()},queryVirtualEntry:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.J)({sysId:"ZW"});case 2:a=t.sent,e.virtualList=a.list;case 4:case"end":return t.stop()}},t,e)}))()},queryNetTypeList:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.C)({regionId:e.formData.resourcePool,sysId:"ZW"});case 2:a=t.sent,e.netTypeList=a.result;case 4:case"end":return t.stop()}},t,e)}))()},queryNetwork:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.D)({sysId:"ZW"});case 2:a=t.sent,e.netList=a.list;case 4:case"end":return t.stop()}},t,e)}))()},getFlavors:function(){var e=this;return i()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.configLoaidng=!0,t.next=4,Object(c.x)({productId:e.productId});case 4:a=t.sent,Array.isArray(a)?(e.flavorList=a,e.handleClickFlavor(a[0])):(r={cpuNum:"",flavorName:"",id:"",memSize:""},e.handleClickFlavor(r)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:return t.prev=11,e.configLoaidng=!1,t.finish(11);case 14:case"end":return t.stop()}},t,e,[[0,8,11,14]])}))()},queryFlavorList:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.B)({regionId:e.formData.resourcePool,sysId:"ZW"});case 2:a=t.sent,e.allFlavorList=a.result;case 4:case"end":return t.stop()}},t,e)}))()},handleClickFlavor:function(e){if(e){var t=this;t.flavorId=e.flavorId;var a=e.cpu,r=e.memeory,s=e.diskType,o=e.comment,n=e.flavorName,i=e.flavorId,c=e.price;a=Number(a),r=Number(r);for(var u=t.allFlavorList,l="",d=0;d<u.length;d++){var p=u[d],m=p.vcpu,f=p.vram,v=p.flavorId;if(m===a&&1024*r===f){l=v;break}}t.flavorData={configFlavorId:i,flavorId:l,diskType:s,flavorName:n,flavorComment:o,flavorPrice:c};for(var y in t.specsData)t.specsData[y]=t.flavorData[y];t.getPrice()}},getPrice:function(){var e=this;return i()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.totalPrice=e.multiply_(e.specsData.flavorPrice,e.formData.buyNum,e.formData.buyTime.keyValue);case 1:case"end":return t.stop()}},t,e)}))()},getImages:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formData.images={},""!==e.formData.resourcePool){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,e.configLoaidng=!0,t.next=7,Object(c.G)({sysId:"ZW",regionId:e.formData.resourcePool});case 7:a=t.sent,e.imagesList=a.result;case 9:return t.prev=9,e.configLoaidng=!1,t.finish(9);case 12:case"end":return t.stop()}},t,e,[[3,,9,12]])}))()},handleNetChange:function(){this.getVpc(),this.getSubnets(),this.getSecurityGroup()},getVpc:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.K)({regionId:e.formData.resourcePool,netId:e.formData.netId,netTypeId:e.formData.netTypeId,sysId:"ZW",custId:""});case 2:a=t.sent,0===a.resultCode&&(e.vpcList=a.result);case 4:case"end":return t.stop()}},t,e)}))()},getSubnets:function(){var e=this;return i()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.I)({netId:e.formData.netId,regionId:e.formData.resourcePool});case 2:a=t.sent,e.subNetList=a.result;case 4:case"end":return t.stop()}},t,e)}))()},getSecurityGroup:function(){var e=this;return i()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.H)({regionId:e.formData.resourcePool,netId:e.formData.netId,sysId:"ZW",custId:e.custId});case 2:a=t.sent,r=a.result,r&&r.length>0&&(e.securityGroupList=r);case 5:case"end":return t.stop()}},t,e)}))()},checkCrm:function(){var e=!1;return""===this.subOrderData.resourcePool&&(this.$message.error("资源池不能为空"),e=!0),e},switchData:function(){var e=this,t=e.projectData,a=e.subOrderData,r=e.flavorData,s=[];s.push({itemId:r.configFlavorId,itemCode:"sysDiskType",itemCodeValue:r.diskType,itemIdType:"subOrder"}),s.push({itemCode:"sysId",itemCodeValue:"ZW"}),s.push({itemCode:"tenantId",itemCodeValue:t.tenantId}),s.push({itemCode:"tenantName",itemCodeValue:t.tenantName}),s.push({itemCode:"numbers",itemCodeValue:a.buyNum,itemIdType:"subOrder"}),s.push({itemCode:"regionId",itemCodeValue:a.resourcePool,itemIdType:"subOrder"}),s.push({itemCode:"flavorId",itemCodeValue:r.flavorId,itemIdType:"subOrder"}),s.push({itemCode:"imageId",itemCodeValue:a.imageId,itemIdType:"subOrder"}),s.push({itemCode:"netId",itemCodeValue:a.netId,itemIdType:"subOrder"}),s.push({itemCode:"netType",itemCodeValue:a.netTypeId,itemIdType:"subOrder"}),s.push({itemCode:"subnetId",itemCodeValue:a.subNet,itemIdType:"subOrder"}),s.push({itemCode:"securityGroupId",itemCodeValue:a.securityGroupId,itemIdType:"subOrder"}),this.configData=s,console.log("this.configData",this.configData)},goOrder:function(){if(!this.checkCrm()){this.switchData();var e=[],t={productId:1,productName:"云主机",orderType:2,projectData:this.projectData,perPrice:this.totalPrice,unitPrice:this.totalPrice,data:this.formData,crmData:this.crmData,productFiles:e,configData:this.configData,flavorId:this.flavorData.flavorId,flavorName:this.flavorData.flavorName,tableShowData:{config:this.flavorData.flavorComment,time:this.formData.buyTime.keyName,num:this.formData.buyNum}};this.orderInitData=t,this.payMent=2}},showPage:function(){this.payMent=1}}},l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"productPage"},[a("product-process",{attrs:{title:"云安全",payMent:e.payMent}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.payMent,expression:"payMent === 1"}],staticClass:"main"},[a("div",{staticClass:"productBox"},[a("el-form",{attrs:{"label-width":"120px","label-position":"left"}},[a("product-user-project",{attrs:{userData:e.crmData},on:{"change-project":e.handleProject,crmData:e.crmInfo}}),e._v(" "),a("product-flavor",{attrs:{type:"zw",flavorId:e.flavorId,flavorList:e.flavorList},on:{"change-flavor":e.handleClickFlavor}}),e._v(" "),a("div",{staticClass:"content-section"},[a("section-title",{attrs:{title:"配置"}}),e._v(" "),a("el-form-item",{attrs:{label:"资源池：",required:""}},[a("el-select",{staticClass:"w-220",on:{change:e.resourceChange},model:{value:e.formData.resourcePool,callback:function(t){e.$set(e.formData,"resourcePool",t)},expression:"formData.resourcePool"}},e._l(e.resourcePoolList,function(e){return a("el-option",{key:e.regionId,attrs:{label:e.regionName,value:e.regionId}})}),1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"购买时长：",required:""}},[a("el-select",{staticClass:"w-220",attrs:{"value-key":"keyValue"},on:{change:e.getPrice},model:{value:e.formData.buyTime,callback:function(t){e.$set(e.formData,"buyTime",t)},expression:"formData.buyTime"}},e._l(e.staticData.timeList,function(e){return a("el-option",{key:e.keyValue,attrs:{label:e.keyName,value:e}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"购买数量：",required:""}},[a("el-input-number",{attrs:{min:1,max:Number(e.staticData.numList.keyValue),step:1,"step-strictly":""},on:{change:e.getPrice},model:{value:e.formData.buyNum,callback:function(t){e.$set(e.formData,"buyNum",t)},expression:"formData.buyNum"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像名称：",required:""}},[a("el-select",{staticClass:"w-220",attrs:{placeholder:"请先选择资源池"},model:{value:e.formData.imageId,callback:function(t){e.$set(e.formData,"imageId",t)},expression:"formData.imageId"}},e._l(e.imagesList,function(e){return a("el-option",{key:e.imageId,attrs:{label:e.imageName,value:e.imageId}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"content-section"},[a("section-title",{attrs:{title:"弹性资源"}}),e._v(" "),e._e(),e._v(" "),a("el-form-item",{attrs:{label:"网络类型",required:""}},[a("el-select",{staticClass:"w-220",model:{value:e.formData.netTypeId,callback:function(t){e.$set(e.formData,"netTypeId",t)},expression:"formData.netTypeId"}},e._l(e.netTypeList,function(e){return a("el-option",{key:e.netTypeId,attrs:{label:e.netTypeName,value:e.netTypeId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"网络：",required:""}},[a("el-select",{staticClass:"w-220",staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"请选择网络"},on:{change:e.handleNetChange},model:{value:e.formData.netId,callback:function(t){e.$set(e.formData,"netId",t)},expression:"formData.netId"}},e._l(e.netList,function(e){return a("el-option",{key:e.netId,attrs:{label:e.netName,value:e.netId}})}),1),e._v(" "),a("el-select",{staticClass:"w-220",attrs:{placeholder:"请选择虚拟私有云"},model:{value:e.formData.vpc,callback:function(t){e.$set(e.formData,"vpc",t)},expression:"formData.vpc"}},e._l(e.vpcList,function(e){return a("el-option",{key:e.netId,attrs:{label:e.netName,value:e.netId}})}),1),e._v(" "),a("el-select",{staticClass:"w-220",attrs:{placeholder:"请选择子网"},on:{change:e.getSecurityGroup},model:{value:e.formData.subNet,callback:function(t){e.$set(e.formData,"subNet",t)},expression:"formData.subNet"}},e._l(e.subNetList,function(e){return a("el-option",{key:e.subnetId,attrs:{label:e.subnetName,value:e.subnetId}})}),1),e._v(" "),a("el-select",{staticClass:"w-220",attrs:{placeholder:"请选择安全组"},model:{value:e.formData.securityGroup,callback:function(t){e.$set(e.formData,"securityGroup",t)},expression:"formData.securityGroup"}},e._l(e.securityGroupList,function(e){return a("el-option",{key:e.securityGroupId,attrs:{label:e.securityGroupName,value:e.securityGroupId}})}),1)],1)],1)],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.priceLoading,expression:"priceLoading"}],staticClass:"rightBox"},[a("product-tool-box",{attrs:{productInfo:e.productInfo,totalPrice:e.totalPrice,specsData:e.specsData},on:{"go-order":e.goOrder}})],1)]),e._v(" "),a("product-order",{directives:[{name:"show",rawName:"v-show",value:2===e.payMent,expression:"payMent === 2"}],attrs:{orderInitData:e.orderInitData},on:{showPage:e.showPage}})],1)},d=[],p={render:l,staticRenderFns:d},m=p,f=a("VU/8"),v=r,y=f(u,m,!1,v,"data-v-685db590",null);t.default=y.exports}});