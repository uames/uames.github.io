webpackJsonp([24],{E3tT:function(e,t,a){"use strict";function r(e){a("F0bF")}Object.defineProperty(t,"__esModule",{value:!0});var o=a("Xxa5"),i=a.n(o),n=a("exGp"),s=a.n(n),c=a("UgCr"),u={components:{},data:function(){return{configLoaidng:!1,payMent:1,crmData:{city:"",region:"",crmCustId:"",crmCustIdTmp:"",showCusId:"",accountId:"",accountIdTmp:"",showAccountId:"",yunAccountInfo:"",yunAccountTmp:"",bizId:""},staticData:{publicNetwork:[]},resourcePoolList:[],selectResourcePool:{},vpcList:[],rules:{name:[{validator:function(e,t,a){if(!t)return a(new Error("实例名不能为空"));a()},trigger:"blur"}]},dataForm:{name:"default",vpc:"",publicNetwork:"",desc:"",resourcePool:""},keyCodeList:{},orderInitData:{}}},computed:{},created:function(){this.getBaseData()},mounted:function(){document.documentElement.scrollTop=0},methods:{getBaseData:function(){var e=this;return s()(i.a.mark(function t(){var a,r,o,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e,t.prev=1,a.configLoaidng=!0,t.next=5,Object(c.r)({typeCode:"publicNetwork"});case 5:if(r=t.sent,Array.isArray(r)){t.next=8;break}return t.abrupt("return");case 8:o=0;case 9:if(!(o<r.length)){t.next=21;break}n=r[o],e.keyCodeList[n.keyValue]=n,t.t0=r[o].typeCode,t.next="publicNetwork"===t.t0?15:17;break;case 15:return a.staticData.publicNetwork.push(r[o]),t.abrupt("break",18);case 17:return t.abrupt("break",18);case 18:o++,t.next=9;break;case 21:a.handlepublicNetworkChange();case 22:return t.prev=22,a.configLoaidng=!1,t.finish(22);case 25:case"end":return t.stop()}},t,e,[[1,,22,25]])}))()},handlepublicNetworkChange:function(){var e=this;e.$nextTick(function(){e.dataForm.publicNetwork=e.staticData.publicNetwork[0].keyValue})},crmInfo:function(e){this.crmData=e,e.bizId&&this.getResourceList()},getResourceList:function(){var e=this;return s()(i.a.mark(function t(){var a,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.configLoaidng=!0,e.dataForm.resourcePool="",t.next=5,Object(c.y)();case 5:a=t.sent,e.resourcePoolList=a,r=a[0],e.dataForm.resourcePool=r.regionId,e.selectResourcePool=r,e.resourceChange();case 11:return t.prev=11,e.configLoaidng=!1,t.finish(11);case 14:case"end":return t.stop()}},t,e,[[0,,11,14]])}))()},changePool:function(e){this.selectResourcePool=e,this.dataForm.resourcePool=e.regionId,this.resourceChange()},resourceChange:function(){try{this.configLoaidng=!0,this.dataForm.vpc="",this.getVpc()}catch(e){console.error(e)}finally{this.configLoaidng=!1}},getVpc:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.configLoaidng=!0,t.next=4,Object(c.v)({type:1,regionId:e.dataForm.resourcePool,crmBizId:e.crmData.bizId,accountId:""});case 4:a=t.sent,a&&a.length>0?(e.vpcList=a,e.dataForm.vpc=a[0].resVpcId):e.createVpc();case 6:return t.prev=6,e.configLoaidng=!1,t.finish(6);case 9:case"end":return t.stop()}},t,e,[[0,,6,9]])}))()},createVpc:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.selectResourcePool.zoneId,t.next=3,Object(c.f)({regionId:e.crmData.regionId,zoneId:a,crmBizId:e.crmData.bizId,type:"1",accountId:""});case 3:case"end":return t.stop()}},t,e)}))()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.goOrder()})},goOrder:function(){this.switchData();var e=[],t={productId:12,productName:"负载均衡",orderType:4,perPrice:"",unitPrice:"",data:this.dataForm,crmData:this.crmData,productFiles:e,configData:this.configData,flavorId:"",flavorName:"",tableShowData:{config:"负载均衡",time:"",num:""}};this.orderInitData=t,this.payMent=2},switchData:function(){var e=this,t=e.dataForm,a=[];a.push({itemCode:"00006029",itemCodeName:e.crmData.bizId,itemCodeValue:e.crmData.bizId,itemId:"00006029",itemIdType:"",itemMode:"",itemName:"云主机BIZID"}),a.push({itemCode:"590039898",itemCodeName:this.selectResourcePool.zoneName,itemCodeValue:this.selectResourcePool.regionId,itemId:"590039898",itemIdType:"",itemMode:"",itemName:"资源池"}),a.push({itemCode:"10020441",itemCodeName:t.vpc,itemCodeValue:t.vpc,itemId:"10020441",itemIdType:"",itemMode:"",itemName:"vpc"}),a.push({itemCode:"描述",itemCodeName:t.desc,itemCodeValue:t.desc,itemId:"描述",itemIdType:"",itemMode:"",itemName:"描述"});var r=this.keyCodeList;for(var o in t){if(["publicNetwork"].includes(o)){var i=t[o],n=r[i];a.push({itemCode:n.keyCode,itemCodeName:n.keyName,itemCodeValue:n.keyValue,itemIdType:n.typeCode,itemId:"",itemMode:"",itemName:""})}}this.configData=a},showPage:function(){this.payMent=1}}},d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"database"},[a("product-process",{attrs:{title:"创建负载均衡",payMent:e.payMent}}),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.configLoaidng,expression:"configLoaidng"},{name:"show",rawName:"v-show",value:1===e.payMent,expression:"payMent === 1"}],staticClass:"dataproduct"},[a("div",{staticClass:"dataproduct-container"},[a("div",{staticClass:"content"},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"status-icon":"","label-width":"120px","label-position":"left"}},[a("product-cust-info",{attrs:{needBizid:!0},on:{crmData:e.crmInfo}}),e._v(" "),a("div",{staticClass:"content-section"},[a("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[a("el-input",{staticClass:"winput",attrs:{autocomplete:"off",size:"small"},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"资源池：",required:""}},[a("el-row",{staticClass:"resource",attrs:{gutter:20}},e._l(e.resourcePoolList,function(t){return a("el-col",{key:t.regionId,staticClass:"resource-item",class:{"active-resourceitem":t.regionId===e.dataForm.resourcePool},attrs:{span:5,value:t.regionId},nativeOn:{click:function(a){return e.changePool(t)}}},[e._v("\n                  "+e._s(t.zoneName)+"\n                ")])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属VPC",required:""}},[a("el-select",{staticClass:"winput",attrs:{placeholder:"请选择虚拟私有云"},model:{value:e.dataForm.vpc,callback:function(t){e.$set(e.dataForm,"vpc",t)},expression:"dataForm.vpc"}},e._l(e.vpcList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.resVpcId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"公网宽带",required:""}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.dataForm.publicNetwork,callback:function(t){e.$set(e.dataForm,"publicNetwork",t)},expression:"dataForm.publicNetwork"}},e._l(e.staticData.publicNetwork,function(e){return a("el-radio-button",{key:e.keyValue,attrs:{label:e.keyValue}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{staticClass:"winput",attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.dataForm.desc,callback:function(t){e.$set(e.dataForm,"desc",t)},expression:"dataForm.desc"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"bottom-container"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{staticClass:"submit-box",attrs:{span:24}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("dataForm")}}},[e._v("\n              立即购买\n            ")])],1)],1)],1)])]),e._v(" "),a("product-order",{directives:[{name:"show",rawName:"v-show",value:2===e.payMent,expression:"payMent === 2"}],attrs:{orderInitData:e.orderInitData},on:{showPage:e.showPage}})],1)},l=[],m={render:d,staticRenderFns:l},p=m,f=a("VU/8"),v=r,h=f(u,p,!1,v,"data-v-2e43bd41",null);t.default=h.exports},F0bF:function(e,t,a){var r=a("MsTj");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("1eed9915",r,!0,{})},MsTj:function(e,t,a){t=e.exports=a("FZ+f")(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"LoadProduct.vue",sourceRoot:""}])}});