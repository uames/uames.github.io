webpackJsonp([24],{"3G7a":function(t,n,e){"use strict";function a(t){e("6z9s")}Object.defineProperty(n,"__esModule",{value:!0});var o=e("Xxa5"),r=e.n(o),i=e("exGp"),c=e.n(i),s=e("Nv8u"),d=e("UgCr"),u=e("HqzV"),l=e("rHil"),p=e("1DHf"),g=e("2sLL"),v=e("rGqP"),x=e("ignk"),m=e("S8Wg"),f=e("YxJB"),A=e("3Lt7"),C=e("HD9R"),h=e("wwIJ"),b=e("pDNl"),_=e("mzja"),B=(u.a,l.a,p.a,g.a,v.a,x.a,m.a,f.a,A.a,C.a,h.a,b.a,_.a,{name:"customerCoupon",components:{Search:u.a,Group:l.a,Cell:p.a,XButton:g.a,Divider:v.a,XTable:x.a,Scroller:m.a,Flexbox:f.a,FlexboxItem:A.a,Popup:C.a,Selector:h.a,XInput:b.a,Alert:_.a},data:function(){return{tableData:[],pageNum:1,pageSize:10,total:1,likeCouponName:"",loading:!1,exchangeDialog:!1,rowData:{},accNum:"",prodId:"379",recordDialog:!1,crmData:{city:"",region:""},cityList:[],regionList:[],couponLoading:!1,descDetail:"",descDialog:!0}},created:function(){this.getRegion(),this.getCouponList()},methods:{handleTablePageChange:function(t){"prev"==t?this.pageNum=this.pageNum-1:"next"==t&&(this.pageNum=this.pageNum+1)},handleSizeChange:function(){},handleCurrentChange:function(){},getCouponList:function(){var t=this;return c()(r.a.mark(function n(){var e;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=t,t.loading=!0,n.next=4,Object(s.h)({userId:t.$store.getters.userInfo.userId,likeCouponName:t.likeCouponName,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){e.total=t.total,e.tableData=t.list}).finally(function(){e.loading=!1});case 4:case"end":return n.stop()}},n,t)}))()},exchange:function(t){this.exchangeDialog=!0,this.rowData=t},exchangeRecord:function(t){this.recordDialog=!0,this.rowData=t},exchangeSure:function(t,n,e){var a=this;return c()(r.a.mark(function o(){var i;return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=a,o.next=3,Object(s.w)({userCouponId:a.rowData.userCouponId,prodInstId:t,applyProductId:a.rowData.applyProductId,custId:n,custName:e,regionId:a.crmData.region,lanId:a.crmData.city,prodId:a.prodId,accNum:a.accNum}).then(function(t){i.exchangeDialog=!1,i.$vux.toast.show({text:"兑换成功",type:"text",time:1500,position:"middle"}),i.getCouponList()});case 3:case"end":return o.stop()}},o,a)}))()},searchUserInfo:function(){var t=this;return c()(r.a.mark(function n(){var e;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=t,""!=t.crmData.region){n.next=4;break}return e.$vux.toast.show({text:"请选择区域",type:"warn",time:3e3,position:"middle"}),n.abrupt("return");case 4:if(""!=t.accNum){n.next=7;break}return e.$vux.toast.show({text:"请输入联系方式",type:"warn",time:3e3,position:"middle"}),n.abrupt("return");case 7:return t.couponLoading=!0,n.next=10,Object(s.g)({accNum:t.accNum,prodId:t.prodId,regionId:t.crmData.region,offerId:t.rowData.applyProductId}).then(function(t){if(!t)return void e.$vux.toast.show({text:"查不到个人信息",type:"warn",time:3e3,position:"middle"});var n=t.list[0];e.$vux.confirm.show({title:"是否确认兑换",content:"<p>姓名："+n.custName+"</p><p>身份证号："+n.certNum+"</p><p>地址："+n.custAddr+"</p>",onCancel:function(){e.$vux.toast.show({text:"已取消兑换",type:"text",time:1500,position:"middle"})},onConfirm:function(){e.exchangeSure(n.prodInstId,n.crmCustId,n.custName)}})}).then(function(){e.couponLoading=!1});case 10:case"end":return n.stop()}},n,t)}))()},getRegion:function(){var t=this;return c()(r.a.mark(function n(){var e;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=t,n.next=3,Object(d.v)(res).then(function(t){e.cityList=t});case 3:case"end":return n.stop()}},n,t)}))()},cityChange:function(){for(var t=0;t<this.cityList.length;t++)if(this.cityList[t].regionId==this.crmData.city){this.regionList=this.cityList[t].children;break}this.crmData.region=""},showDesc:function(t){this.$vux.alert.show({title:"提示",content:t,onShow:function(){},onHide:function(){}})}}}),D=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"customerCoupon"},[e("search",{ref:"search",attrs:{placeholder:"优惠券名称","auto-fixed":!1,position:"relative"},on:{"on-change":t.getCouponList},model:{value:t.likeCouponName,callback:function(n){t.likeCouponName=n},expression:"likeCouponName"}}),t._v(" "),e("scroller",{attrs:{"lock-y":"","scrollbar-x":""}},[e("x-table",{staticStyle:{"background-color":"#fff",width:"700px"}},[e("thead",[e("tr",{staticStyle:{"background-color":"#f6f7fb"}},[e("th",[t._v("优惠券名称")]),t._v(" "),e("th",[t._v("金额")]),t._v(" "),e("th",[t._v("关联商品")]),t._v(" "),e("th",[t._v("优惠券码")]),t._v(" "),e("th",[t._v("来源")]),t._v(" "),e("th",[t._v("状态")]),t._v(" "),e("th",[t._v("优惠券规则")]),t._v(" "),e("th",[t._v("可兑换时长（月）")]),t._v(" "),e("th",[t._v("生效时间")]),t._v(" "),e("th",[t._v("有效期")]),t._v(" "),e("th",[t._v("操作")])])]),t._v(" "),e("tbody",[0==t.tableData.length?e("tr",[e("td",{attrs:{colspan:"11"}},[t._v("暂无数据")])]):t._e(),t._v(" "),t._l(t.tableData,function(n){return e("tr",[e("td",[t._v(t._s(n.couponName))]),t._v(" "),e("td",[t._v(t._s(n.couponPrice))]),t._v(" "),e("td",[t._v(t._s(n.bindProductName))]),t._v(" "),e("td",[t._v(t._s(n.couponSn))]),t._v(" "),e("td",[t._v(t._s(n.couponSource))]),t._v(" "),e("td",[t._v(t._s(1==n.userCouponStatus?"已使用":"未使用"))]),t._v(" "),e("td",[e("span",{staticClass:"ruleBtn",on:{click:function(e){return t.showDesc(n.couponDesc)}}},[t._v("查看")])]),t._v(" "),e("td",[t._v(t._s(n.awardDuration))]),t._v(" "),e("td",[t._v(t._s(n.couponStartDate))]),t._v(" "),e("td",[t._v(t._s(n.couponEndDate))]),t._v(" "),e("td",[1!==n.userCouponStatus?e("x-button",{attrs:{type:"primary",mini:""},nativeOn:{click:function(e){return t.exchange(n)}}},[t._v("兑换")]):t._e(),t._v(" "),1==n.userCouponStatus?e("x-button",{attrs:{type:"primary",mini:""},nativeOn:{click:function(e){return t.exchangeRecord(n)}}},[t._v("兑换记录")]):t._e()],1)])})],2)])],1),t._v(" "),e("div",{staticClass:"pagination"},[e("flexbox",[e("flexbox-item",[e("x-button",{attrs:{type:"default",disabled:t.pageNum<=1},nativeOn:{click:function(n){return t.handleTablePageChange("prev")}}},[t._v("上一页")])],1),t._v(" "),e("flexbox-item",[e("div",{staticClass:"current-page"},[t._v(" "+t._s((0==t.total?0:t.pageNum)+"/"+t.total))])]),t._v(" "),e("flexbox-item",[e("x-button",{attrs:{type:"default",disabled:t.pageNum==t.total||0==t.total},nativeOn:{click:function(n){return t.handleTablePageChange("next")}}},[t._v("下一页")])],1)],1)],1),t._v(" "),e("popup",{attrs:{"should-rerender-on-show":!0},model:{value:t.exchangeDialog,callback:function(n){t.exchangeDialog=n},expression:"exchangeDialog"}},[e("group",[e("cell",{attrs:{primary:"content",title:"请输入需要兑换的手机号（请先阅读兑换规则再进行兑换）"}}),t._v(" "),e("selector",{attrs:{title:"城市","value-map":["regionId","regionName"],options:t.cityList},model:{value:t.crmData.city,callback:function(n){t.$set(t.crmData,"city",n)},expression:"crmData.city"}}),t._v(" "),e("selector",{attrs:{title:"区域","value-map":["regionId","regionName"],options:t.regionList},model:{value:t.crmData.region,callback:function(n){t.$set(t.crmData,"region",n)},expression:"crmData.region"}}),t._v(" "),e("XInput",{attrs:{title:"手机号",type:"tel",placeholder:"请输入手机号"},model:{value:t.accNum,callback:function(n){t.accNum=n},expression:"accNum"}}),t._v(" "),e("div",{staticStyle:{padding:"15px"}},[e("flexbox",[e("flexbox-item",[e("x-button",{attrs:{type:"warn"},nativeOn:{click:function(n){t.exchangeDialog=!1}}},[t._v("取消")])],1),t._v(" "),e("flexbox-item",[e("x-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.searchUserInfo(n)}}},[t._v("确定")])],1)],1)],1)],1)],1),t._v(" "),e("popup",{attrs:{"should-rerender-on-show":!0},model:{value:t.recordDialog,callback:function(n){t.recordDialog=n},expression:"recordDialog"}},[e("group",{attrs:{title:"兑换记录"}},[e("cell",{attrs:{primary:"content",title:"时间"}},[t._v(t._s(t.rowData.awardDate))]),t._v(" "),e("cell",{attrs:{primary:"content",title:"状态"}},[t._v("已兑换")]),t._v(" "),e("cell",{attrs:{primary:"content",title:"兑换流水"}},[t._v(t._s(t.rowData.serialNo))]),t._v(" "),e("cell",{attrs:{primary:"content",title:"兑换对象"}},[t._v(t._s(t.rowData.couponName))]),t._v(" "),e("cell",{attrs:{primary:"content",title:"兑换系统"}},[t._v("CRM")]),t._v(" "),e("div",{staticStyle:{padding:"15px"}},[e("flexbox",[e("flexbox-item",[e("x-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.recordDialog(n)}}},[t._v("确定")])],1)],1)],1)],1)],1)],1)},w=[],y={render:D,staticRenderFns:w},E=y,k=e("VU/8"),N=a,I=k(B,E,!1,N,"data-v-7b9cf4da",null);n.default=I.exports},"6z9s":function(t,n,e){var a=e("eQHc");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("665a34ad",a,!0,{})},eQHc:function(t,n,e){n=t.exports=e("FZ+f")(!0),n.push([t.i,"\n.title[data-v-7b9cf4da] {\n  font-size: 16px;\n  padding: 20px;\n  border-bottom: solid 1px #e8ebee;\n  margin-bottom: 10px;\n}\n.formBox[data-v-7b9cf4da] {\n  padding-left: 20px;\n}\n.pageBox[data-v-7b9cf4da] {\n  margin: 20px 20px 0 0;\n}\n.tableBox[data-v-7b9cf4da] {\n  width: 100%;\n  padding: 0 1px;\n}\n.exchangeBox[data-v-7b9cf4da] {\n  padding: 0 20px;\n}\n.exchangeBox p[data-v-7b9cf4da] {\n  margin-bottom: 30px;\n  font-weight: bold;\n  text-align: center;\n}\n.recordBox[data-v-7b9cf4da] {\n  padding: 0 20px;\n}\n.alignCenter[data-v-7b9cf4da] {\n  text-align: center;\n}\n.w-220[data-v-7b9cf4da] {\n  width: 220px;\n  margin-right: 20px;\n}\n.exchangeBtn[data-v-7b9cf4da] {\n  text-align: center;\n  margin-left: -120px;\n}\n.ruleBtn[data-v-7b9cf4da] {\n  color: #F56C6C;\n  cursor: pointer;\n}\n.customerCoupon .el-dialog[data-v-7b9cf4da] {\n  min-width: 750px;\n}\n.input-with-select .el-select .el-input[data-v-7b9cf4da] {\n  width: 130px;\n}\n.pagination[data-v-7b9cf4da] {\n  margin: 10px 20px;\n}\n.pagination .current-page[data-v-7b9cf4da] {\n  text-align: center;\n  color: #2DB9F9;\n}\n","",{version:3,sources:["D:/work/git/nxcloud/src/pages/manage/customer/CustomerCoupon.vue"],names:[],mappings:";AACA;EACE,gBAAgB;EAChB,cAAc;EACd,iCAAiC;EACjC,oBAAoB;CACrB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,sBAAsB;CACvB;AACD;EACE,YAAY;EACZ,eAAe;CAChB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,oBAAoB;EACpB,kBAAkB;EAClB,mBAAmB;CACpB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,aAAa;EACb,mBAAmB;CACpB;AACD;EACE,mBAAmB;EACnB,oBAAoB;CACrB;AACD;EACE,eAAe;EACf,gBAAgB;CACjB;AACD;EACE,iBAAiB;CAClB;AACD;EACE,aAAa;CACd;AACD;EACE,kBAAkB;CACnB;AACD;EACE,mBAAmB;EACnB,eAAe;CAChB",file:"CustomerCoupon.vue",sourcesContent:["\n.title[data-v-7b9cf4da] {\n  font-size: 16px;\n  padding: 20px;\n  border-bottom: solid 1px #e8ebee;\n  margin-bottom: 10px;\n}\n.formBox[data-v-7b9cf4da] {\n  padding-left: 20px;\n}\n.pageBox[data-v-7b9cf4da] {\n  margin: 20px 20px 0 0;\n}\n.tableBox[data-v-7b9cf4da] {\n  width: 100%;\n  padding: 0 1px;\n}\n.exchangeBox[data-v-7b9cf4da] {\n  padding: 0 20px;\n}\n.exchangeBox p[data-v-7b9cf4da] {\n  margin-bottom: 30px;\n  font-weight: bold;\n  text-align: center;\n}\n.recordBox[data-v-7b9cf4da] {\n  padding: 0 20px;\n}\n.alignCenter[data-v-7b9cf4da] {\n  text-align: center;\n}\n.w-220[data-v-7b9cf4da] {\n  width: 220px;\n  margin-right: 20px;\n}\n.exchangeBtn[data-v-7b9cf4da] {\n  text-align: center;\n  margin-left: -120px;\n}\n.ruleBtn[data-v-7b9cf4da] {\n  color: #F56C6C;\n  cursor: pointer;\n}\n.customerCoupon .el-dialog[data-v-7b9cf4da] {\n  min-width: 750px;\n}\n.input-with-select .el-select .el-input[data-v-7b9cf4da] {\n  width: 130px;\n}\n.pagination[data-v-7b9cf4da] {\n  margin: 10px 20px;\n}\n.pagination .current-page[data-v-7b9cf4da] {\n  text-align: center;\n  color: #2DB9F9;\n}\n"],sourceRoot:""}])}});