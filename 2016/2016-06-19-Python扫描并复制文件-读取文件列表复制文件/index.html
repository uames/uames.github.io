<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Python扫描并复制文件，读取文件列表复制文件 · A place for myself to write something</title><meta name="description" content="Python扫描并复制文件，读取文件列表复制文件 - uames"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/uames" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Python扫描并复制文件，读取文件列表复制文件</h1><div class="post-info">Jun 19, 2016</div><div class="post-content"><p>因为项目需要，我负责上传文件，昨天整理了一些文件，但是今天又改了下，不想手动一个个复制，于是想用程序解决，从cmd到shell到java，突然想到python应该会有这种小程序，上网搜了下，果然有，“Python扫描并复制文件”。拿来用了下，修了点不适合我环境的bug，然后程序成功运行了，文件也copy过去了。</p>
<p>然后还有个需求，我这边上传文件，同事只是发个文件的相对地址给我，我还是得手动copy，于是修改代码，最后出来的结果是这样的，之前的功能还保留了，用参数控制不同的功能。</p>
<p>代码使用方法已经放在文件头部了。这是我第一次折腾python的代码，之前的经验只是从github上下了个项目pyrailgun，运行里面的demo学习了下。那是个爬虫插件。</p>
<p>总之，感觉还是挺好玩的，有空的话，我还想用nodejs把这个功能实现一下～</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># 第一种用法（替换已经复制了的文件），配置好下面要扫描替换的目录，直接运行 python copyNewToDest.py</span><br><span class="line"># 第二种用法（直接复制文件），配置好SOURCE_PATH2（源目录）和DEST_PATH（目标目录），</span><br><span class="line">	#运行 python copyNewToDest.py copyMobile, copyMobile中放目录中要copy的文件路径，多个文件换行即可</span><br><span class="line">	#除了Application和Public文件夹，其它均需要正确的相对路径</span><br><span class="line"># 第三种用法（配置多个copy目录），配置好对应条件后的代码，运行python copyNewToDest.py copyEasy easy, 最后一个参数值easy代表不同的项目</span><br><span class="line">import os</span><br><span class="line">import shutil</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">SOURCE_PATH1=r&apos;C:\Users\jim\Desktop\tzb_mobile\0-wait-to-online&apos;;#比对目录，提供文件名</span><br><span class="line">SOURCE_PATH2=r&apos;D:\wamp\apps\mobile&apos;;#要复制出来的目录 D:\wamp\apps\mobile</span><br><span class="line">DEST_PATH=r&apos;C:\Users\jim\Desktop\tzb_mobile\0-wait-to-online&apos;#目标目录</span><br><span class="line"></span><br><span class="line">if len(sys.argv)==3 and sys.argv[2]==&apos;easy&apos;:</span><br><span class="line">	SOURCE_PATH1=r&apos;C:\Users\jim\Desktop\tzb_easypro\0-wait-to-online&apos;;#比对目录，提供文件名</span><br><span class="line">	SOURCE_PATH2=r&apos;D:\wamp\apps\tzb_easy&apos;;#要复制出来的目录 D:\wamp\apps\mobile</span><br><span class="line">	DEST_PATH=r&apos;C:\Users\jim\Desktop\tzb_easypro\0-wait-to-online&apos;#目标目录</span><br><span class="line"></span><br><span class="line">def ReadFileNames(rootDir):</span><br><span class="line">    FileList = []</span><br><span class="line">    for parent,dirNames,fileNames in os.walk(rootDir):</span><br><span class="line">        if fileNames:</span><br><span class="line">            for fileName in fileNames:</span><br><span class="line">                FileList.append(os.path.join(parent,fileName))</span><br><span class="line">    return FileList</span><br><span class="line"></span><br><span class="line">#搜索字符串中所有的子字符串，暂未用到</span><br><span class="line">def SearchStr(str,search):</span><br><span class="line">	start = 0</span><br><span class="line">	while True:</span><br><span class="line">		index = str.find(search, start)</span><br><span class="line">		# if search string not found, find() returns -1</span><br><span class="line">		# search is complete, break out of the while loop</span><br><span class="line">		if index == -1:</span><br><span class="line">			break</span><br><span class="line">		print( &quot;%s found at index %d&quot; % (search, index) )</span><br><span class="line">		# move to next possible start position</span><br><span class="line">		start = index + 1</span><br><span class="line"></span><br><span class="line">#main()</span><br><span class="line">if len(sys.argv)==1:</span><br><span class="line">	print sys.argv[0]</span><br><span class="line">	if __name__==&apos;__main__&apos;:</span><br><span class="line">		if not os.path.exists(DEST_PATH):</span><br><span class="line">			os.makedirs(DEST_PATH)</span><br><span class="line">		fileList = ReadFileNames(SOURCE_PATH1)</span><br><span class="line">		for oldfileName in fileList:</span><br><span class="line">			print oldfileName</span><br><span class="line">			newfileName = oldfileName.replace(SOURCE_PATH1, SOURCE_PATH2)</span><br><span class="line">			destfileName = oldfileName.replace(SOURCE_PATH1, DEST_PATH)</span><br><span class="line">			destdirName =  os.path.dirname(destfileName)</span><br><span class="line">			if not os.path.exists(destdirName):</span><br><span class="line">				os.makedirs(destdirName)</span><br><span class="line">			shutil.copyfile(newfileName,destfileName)</span><br><span class="line">			print &apos;copy&apos;,newfileName,&apos;--&gt;&apos;,destfileName</span><br><span class="line">if len(sys.argv)&gt;2 and len(sys.argv[1])&gt;=4:</span><br><span class="line">	if __name__==&apos;__main__&apos;:</span><br><span class="line">		print sys.argv[1]</span><br><span class="line">		if not os.path.exists(DEST_PATH):</span><br><span class="line">			os.makedirs(DEST_PATH)</span><br><span class="line">		fileList = file(sys.argv[1]).readlines()</span><br><span class="line">		for oldfileName in fileList:</span><br><span class="line">			oldfileName=oldfileName.strip(&apos;\n&apos;)</span><br><span class="line">			nPos = oldfileName.find(&apos;Application&apos;,0)</span><br><span class="line">			if nPos&lt;0:</span><br><span class="line">				nPos = oldfileName.find(&apos;Public&apos;,0)</span><br><span class="line">			if nPos&gt;0:</span><br><span class="line">				oldfileName = oldfileName[nPos-1:]</span><br><span class="line">			#newfileName = oldfileName.replace(sys.argv[1], SOURCE_PATH2)</span><br><span class="line">			#destfileName = oldfileName.replace(sys.argv[1], DEST_PATH)</span><br><span class="line">			newfileName = SOURCE_PATH2 + oldfileName</span><br><span class="line">			destfileName = DEST_PATH + oldfileName</span><br><span class="line">			destdirName =  os.path.dirname(destfileName)</span><br><span class="line">			if not os.path.exists(destdirName):</span><br><span class="line">				os.makedirs(destdirName)</span><br><span class="line">			shutil.copyfile(newfileName,destfileName)</span><br><span class="line">			print &apos;copy&apos;,newfileName,&apos;--&gt;&apos;,destfileName</span><br></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2016/angular/2016-06-25-使用$emit, $broadcast和$on在父级和子级controller间传递数据/" class="prev">PREV</a><a href="/2016/2016-07-10-about js front/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2019 <a href="https://uames.github.io">uames</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>